<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="supported-color-schemes" content="light dark">
<meta name="color-scheme" content="light dark">
<meta name="dir" :content="layoutDirection">
    <title>Ramadan Timer</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+Arabic:wght@100..900&family=Rubik:ital,wght@0,300..900;1,300..900&display=swap" rel="stylesheet">
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- Tailwind CSS with class-based dark mode -->
    <script>
        tailwind.config = {
            darkMode: 'class', // Class-based dark mode
            theme: {
                extend: {
                    fontFamily: {
                        sans: ['Rubik', 'sans-serif'],
                        arabic: ['Noto Sans Arabic', 'serif']
                    },
                    colors: {
                        primary: {
                            50: '#f0f7ff',
                            100: '#e0f0ff',
                            500: '#3b82f6',
                            600: '#2563eb',
                            700: '#1d4ed8'
                        }
                    }
                }
            }
        }
    </script>
    <script src="https://cdn.jsdelivr.net/npm/vue@3.3.4/dist/vue.global.min.js"></script>
    <script>
    // Check for dark mode before the page loads to prevent flashing
    if (localStorage.getItem('darkMode') === 'true' || 
        (!localStorage.getItem('darkMode') && window.matchMedia('(prefers-color-scheme: dark)').matches)) {
        document.documentElement.classList.add('dark');
    }
    </script>
    <style>
        @font-face {
            font-family: 'Noto Sans Arabic';
            src: url('https://cdnjs.cloudflare.com/ajax/libs/noto-sans/2021-08-02/noto-sans-arabic/NotoSansArabic-Regular.ttf') format('truetype');
            font-weight: normal;
            font-style: normal;
        }
        .font-arabic {
            font-family: 'Amiri', 'Noto Sans Arabic', serif;
        }
        .rtl {
            direction: rtl;
        }
        .ltr {
            direction: ltr;
        }
        
        /* Smooth transitions */
        .fade-transition {
            transition: all 0.3s ease;
        }
        
        /* Glassmorphism effect */
        .glass {
            background: rgba(255, 255, 255, 0.1);
            backdrop-filter: blur(10px);
            -webkit-backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.2);
        }
        /*
        .dark .glass {
            background: rgba(30, 41, 59, 0.4);
            border: 1px solid rgba(255, 255, 255, 0.1);
        }
        */
        /* Custom animation for moon phases */
        @keyframes glow {
            0% { box-shadow: 0 0 5px rgba(129, 140, 248, 0.5); }
            50% { box-shadow: 0 0 20px rgba(129, 140, 248, 0.8); }
            100% { box-shadow: 0 0 5px rgba(129, 140, 248, 0.5); }
        }
        
        /* Enhanced Moon Phase Styles */
.moon-glow {
  animation: moonGlow 4s infinite;
  box-shadow: 0 0 15px rgba(129, 140, 248, 0.3);
}

@keyframes moonGlow {
  0% { 
    box-shadow: 0 0 15px rgba(129, 140, 248, 0.3);
  }
  50% { 
    box-shadow: 0 0 25px rgba(129, 140, 248, 0.5),
                0 0 35px rgba(129, 140, 248, 0.2);
  }
  100% { 
    box-shadow: 0 0 15px rgba(129, 140, 248, 0.3);
  }
}

/* Smooth transitions for phase changes */
.moon-phase-transition {
  transition: all 0.5s cubic-bezier(0.4, 0, 0.2, 1);
}

/* Dark mode specific adjustments */
.dark .moon-glow {
  box-shadow: 0 0 15px rgba(129, 140, 248, 0.4);
}

/* Enhanced visibility for phase text */
.phase-label {
  text-shadow: 0 1px 2px rgba(0, 0, 0, 0.1);
}
        
        /* Custom scrollbar */
        ::-webkit-scrollbar {
            width: 8px;
        }
        
        ::-webkit-scrollbar-track {
            background: #f1f1f1;
        }
        
        .dark ::-webkit-scrollbar-track {
            background: #1e293b;
        }
        
        ::-webkit-scrollbar-thumb {
            background: #cbd5e1;
            border-radius: 4px;
        }
        
        .dark ::-webkit-scrollbar-thumb {
            background: #475569;
        }
        
        ::-webkit-scrollbar-thumb:hover {
            background: #94a3b8;
        }
        
        .dark ::-webkit-scrollbar-thumb:hover {
            background: #64748b;
        }
    </style>
</head>
<body class="bg-gradient-to-br from-slate-50 to-slate-100 dark:from-slate-900 dark:to-slate-800 text-slate-800 dark:text-slate-200 min-h-screen transition-colors duration-500 font-arabic" :class="{'rtl text-right': language === 'ar'}">
    <div id="app" class="max-w-6xl mx-auto p-4 md:p-6">
        <header class="flex justify-between items-center mb-6 bg-white/80 dark:bg-slate-800/80 backdrop-blur-sm rounded-xl shadow-sm p-4">
            <div class="flex items-center gap-3">
            
                <h1 class="text-2xl font-bold bg-gradient-to-r from-indigo-700 to-purple-600 dark:from-indigo-400 dark:to-purple-500 bg-clip-text text-transparent">{{ language === 'en' ? 'Ramadan Timer' : 'Ù…Ø¤Ù‚Øª Ø±Ù…Ø¶Ø§Ù†' }}</h1>
            </div>
            <div class="flex gap-3">
                <button @click="toggleDarkMode" class="bg-slate-200 dark:bg-slate-700 hover:bg-slate-300 dark:hover:bg-slate-600 text-slate-800 dark:text-slate-200 p-2 rounded-lg transition-all duration-300 hover:shadow-md">
                    <span v-if="darkMode" class="block w-6 h-6">ğŸŒ</span><span v-else class="block w-6 h-6">ğŸŒœ</span>
                </button>
                <button @click="toggleLanguage" class="bg-gradient-to-r from-indigo-600 to-purple-600 hover:from-indigo-700 hover:to-purple-700 text-white px-4 py-2 rounded-lg transition-all duration-300 hover:shadow-md">
                    {{ language === 'en' ? 'Ø§Ù„Ø¹Ø±Ø¨ÙŠØ©' : 'English' }}
                </button>
            </div>
        </header>

        <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
            <!-- Timer Card -->
            <div class="bg-white/90 dark:bg-slate-800/90 backdrop-blur-sm rounded-2xl shadow-lg overflow-hidden transition-all duration-300 hover:shadow-xl border border-slate-200 dark:border-slate-700">
                <!-- Moon Phase -->
                <div class="bg-gradient-to-r from-indigo-500 to-purple-600  p-8 flex flex-col items-center relative overflow-hidden">
                    <!-- Moon Phase Component - Enhanced Version -->
<div class="relative w-28 h-28 mb-5 moon-glow rounded-full">
  <!-- Base moon circle with realistic texture -->
  <div class="absolute inset-0 w-28 h-28 rounded-full bg-gradient-to-r from-slate-100 to-white dark:from-slate-300 dark:to-white overflow-hidden">
    <!-- Realistic moon texture overlay -->
    <div class="absolute inset-0 opacity-20 dark:opacity-30 bg-cover bg-center"
         style="background-image: url('https://upload.wikimedia.org/wikipedia/commons/thumb/e/e1/FullMoon2010.jpg/800px-FullMoon2010.jpg');">
    </div>
  </div>
  
  <!-- Dynamic moon phase mask -->
  <div class="absolute inset-0 w-28 h-28 bg-indigo-900/95 dark:bg-slate-900/95 rounded-full moon-phase-transition"
       :style="moonPhaseStyle">
    <!-- Subtle shadow gradient for depth -->
    <div class="absolute inset-0 bg-gradient-to-r from-transparent via-black/10 to-transparent dark:via-black/20 rounded-full">
    </div>
  </div>
  
  <!-- Illumination effect -->
  <div class="absolute inset-0 w-28 h-28 rounded-full opacity-30"
       :style="illuminationStyle">
    <div class="absolute inset-0 bg-gradient-to-r from-indigo-400/30 to-transparent dark:from-indigo-300/30 rounded-full"></div>
  </div>
  
  <!-- Phase indicator label -->
  <div class="absolute -bottom-8 left-1/2 transform -translate-x-1/2 text-sm font-medium text-indigo-600 dark:text-indigo-400 whitespace-nowrap phase-label">
    {{ phaseName }}
  </div>
</div>
                </div>

                <div class="p-6 text-center">
                    <div class="flex justify-center gap-4 items-center mb-4">
                        <p class="text-slate-600 dark:text-slate-300">{{ language === 'en' ? currentDate : currentDateArabic }}</p>
                        <div class="h-4 w-px bg-slate-300 dark:bg-slate-600"></div>
                        <p class="text-indigo-600 dark:text-indigo-400 font-medium">{{ language === 'en' ? hijriDate : hijriDateArabic }}</p>
                    </div>
                    
                    <h2 class="text-xl font-bold mt-6 dark:text-slate-200 bg-gradient-to-r from-indigo-700 to-purple-600 dark:from-indigo-400 dark:to-purple-500 bg-clip-text text-transparent">{{ language === 'en' ? countdownLabel : countdownLabelArabic }}</h2>
                    
                    <div class="flex justify-center gap-3 my-8">
                        <div class="bg-gradient-to-b from-indigo-50 to-indigo-100 dark:from-indigo-900/50 dark:to-purple-900/30 rounded-xl px-5 py-3 shadow-sm">
                            <div class="text-4xl font-bold bg-gradient-to-r from-indigo-700 to-purple-600 dark:from-indigo-400 dark:to-purple-500 bg-clip-text text-transparent">{{ countdownTime.hours }}</div>
                            <div class="text-xs text-slate-500 dark:text-slate-400 mt-1">{{ language === 'en' ? 'Hours' : 'Ø³Ø§Ø¹Ø§Øª' }}</div>  
                        </div>
                        <div class="text-2xl self-center text-slate-400 dark:text-slate-500 font-light">:</div>
                        <div class="bg-gradient-to-b from-indigo-50 to-indigo-100 dark:from-indigo-900/50 dark:to-purple-900/30 rounded-xl px-5 py-3 shadow-sm">
                            <div class="text-4xl font-bold bg-gradient-to-r from-indigo-700 to-purple-600 dark:from-indigo-400 dark:to-purple-500 bg-clip-text text-transparent">{{ countdownTime.minutes }}</div>
                            <div class="text-xs text-slate-500 dark:text-slate-400 mt-1">{{ language === 'en' ? 'Minutes' : 'Ø¯Ù‚Ø§Ø¦Ù‚' }}</div>
                        </div>
                        <div class="text-2xl self-center text-slate-400 dark:text-slate-500 font-light">:</div>
                        <div class="bg-gradient-to-b from-indigo-50 to-indigo-100 dark:from-indigo-900/50 dark:to-purple-900/30 rounded-xl px-5 py-3 shadow-sm">
                            <div class="text-4xl font-bold bg-gradient-to-r from-indigo-700 to-purple-600 dark:from-indigo-400 dark:to-purple-500 bg-clip-text text-transparent">{{ countdownTime.seconds }}</div>
                            <div class="text-xs text-slate-500 dark:text-slate-400 mt-1">{{ language === 'en' ? 'Seconds' : 'Ø«ÙˆØ§Ù†ÙŠ' }}</div>
                        </div>
                    </div>
                    
                    <!-- Progress Bar -->
                    <div class="w-full bg-slate-100 dark:bg-slate-700 rounded-full h-3 mb-3 overflow-hidden">
                        <div class="bg-gradient-to-r h-3 rounded-full transition-all duration-500 relative" 
                             :class="progressBarColor"
                             :style="{width: `${progressPercentage}%`}">
                            <div class="absolute inset-0 opacity-30 bg-[radial-gradient(circle_at_30%_107%,rgba(255,255,255,0.8)_0%,rgba(255,255,255,0)_80%)]"></div>
                        </div>
                    </div>
                    <p class="text-xs text-slate-500 dark:text-slate-400 mb-6">{{ progressPercentage.toFixed(1) }}% {{ language === 'en' ? 'Complete' : 'Ù…ÙƒØªÙ…Ù„' }}</p>
                    
                    <!-- Prayer Times -->
                    <div class="grid grid-cols-2 gap-4 mt-8">
                        <div class="bg-gradient-to-b from-slate-50 to-slate-100 dark:from-slate-800 dark:to-slate-700 rounded-xl p-5 shadow-sm border border-slate-200 dark:border-slate-700 transition-all duration-300 hover:shadow-md hover:border-indigo-200 dark:hover:border-indigo-900">
                            <div class="flex items-center justify-center mb-2">
                                <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 text-indigo-600 dark:text-indigo-400 mr-2" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M20.354 15.354A9 9 0 018.646 3.646 9.003 9.003 0 0012 21a9.003 9.003 0 008.354-5.646z" />
                                </svg>
                                <h3 class="text-sm font-medium text-slate-600 dark:text-slate-300">{{ language === 'en' ? 'Imsk Time' : 'ÙˆÙ‚Øª Ø§Ù„Ø³Ø­ÙˆØ±' }}</h3>
                            </div>
                            <div class="text-2xl font-bold text-indigo-700 dark:text-indigo-400">{{ formatTime(prayerTimes.suhoor )}}</div>
                        </div>
                        <div class="bg-gradient-to-b from-slate-50 to-slate-100 dark:from-slate-800 dark:to-slate-700 rounded-xl p-5 shadow-sm border border-slate-200 dark:border-slate-700 transition-all duration-300 hover:shadow-md hover:border-indigo-200 dark:hover:border-indigo-900">
                            <div class="flex items-center justify-center mb-2">
                                <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 text-indigo-600 dark:text-indigo-400 mr-2" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 3v1m0 16v1m9-9h-1M4 12H3m15.364 6.364l-.707-.707M6.343 6.343l-.707-.707m12.728 0l-.707.707M6.343 17.657l-.707.707" />
                                </svg>
                                <h3 class="text-sm font-medium text-slate-600 dark:text-slate-300">{{ language === 'en' ? 'Iftar Time' : 'ÙˆÙ‚Øª Ø§Ù„Ø¥ÙØ·Ø§Ø±' }}</h3>
                            </div>
                            <div class="text-2xl font-bold text-indigo-700 dark:text-indigo-400">{{ formatTime(prayerTimes.iftar )}}</div>
                        </div>
                    </div>
                    
                    <div class="bg-gradient-to-b from-slate-50 to-slate-100 dark:from-slate-800 dark:to-slate-700 rounded-xl p-5 mt-4 shadow-sm border border-slate-200 dark:border-slate-700 transition-all duration-300 hover:shadow-md hover:border-indigo-200 dark:hover:border-indigo-900">
                        <div class="flex items-center justify-center mb-2">
                            <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 text-indigo-600 dark:text-indigo-400 mr-2" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z" />
                </svg>
                <h3 class="text-sm font-medium text-slate-600 dark:text-slate-300">{{ language === 'en' ? 'Fast Duration' : 'Ù…Ø¯Ø© Ø§Ù„ØµÙŠØ§Ù…' }}</h3>
            </div>
            <div class="text-2xl font-bold text-indigo-700 dark:text-indigo-400">{{ language === 'en' ? fastDuration : fastDurationArabic }}</div>
        </div>
    </div>
</div>

<!-- Settings Card -->
<div class="bg-white/90 dark:bg-slate-800/90 backdrop-blur-sm rounded-2xl shadow-lg overflow-hidden p-6 transition-all duration-300 hover:shadow-xl border border-slate-200 dark:border-slate-700">
    <div class="flex items-center mb-6">
        <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6 text-indigo-600 dark:text-indigo-400 mr-3" fill="none" viewBox="0 0 24 24" stroke="currentColor">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10.325 4.317c.426-1.756 2.924-1.756 3.35 0a1.724 1.724 0 002.573 1.066c1.543-.94 3.31.826 2.37 2.37a1.724 1.724 0 001.065 2.572c1.756.426 1.756 2.924 0 3.35a1.724 1.724 0 00-1.066 2.573c.94 1.543-.826 3.31-2.37 2.37a1.724 1.724 0 00-2.572 1.065c-.426 1.756-2.924 1.756-3.35 0a1.724 1.724 0 00-2.573-1.066c-1.543.94-3.31-.826-2.37-2.37a1.724 1.724 0 00-1.065-2.572c-1.756-.426-1.756-2.924 0-3.35a1.724 1.724 0 001.066-2.573c-.94-1.543.826-3.31 2.37-2.37.996.608 2.296.07 2.572-1.065z" />
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 12a3 3 0 11-6 0 3 3 0 016 0z" />
        </svg>
        <h2 class="text-xl font-bold bg-gradient-to-r from-indigo-700 to-purple-600 dark:from-indigo-400 dark:to-purple-500 bg-clip-text text-transparent">{{ language === 'en' ? 'Location Settings' : 'Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª Ø§Ù„Ù…ÙˆÙ‚Ø¹' }}</h2>
    </div>
    
    <div class="space-y-5">
        <div class="group">
            <label class="block text-sm font-medium mb-2 text-slate-700 dark:text-slate-300 group-hover:text-indigo-600 dark:group-hover:text-indigo-400 transition-colors duration-300">{{ language === 'en' ? 'Calculation Method' : 'Ø·Ø±ÙŠÙ‚Ø© Ø§Ù„Ø­Ø³Ø§Ø¨' }}</label>
            <div class="relative">
                <select v-model="calculationMethod" 
                        class="w-full p-3 border border-slate-300 dark:border-slate-600 rounded-xl focus:ring-2 focus:ring-indigo-300 dark:focus:ring-indigo-700 focus:border-indigo-500 dark:focus:border-indigo-500 focus:outline-none bg-white dark:bg-slate-700 text-slate-800 dark:text-slate-200 pr-10 appearance-none transition-all duration-300">
                    <option value="ISNA">{{ language === 'en' ? 'Islamic Society of North America' : 'Ø§Ù„Ø¬Ù…Ø¹ÙŠØ© Ø§Ù„Ø¥Ø³Ù„Ø§Ù…ÙŠØ© Ù„Ø£Ù…Ø±ÙŠÙƒØ§ Ø§Ù„Ø´Ù…Ø§Ù„ÙŠØ©' }}</option>
                    <option value="MWL">{{ language === 'en' ? 'Muslim World League' : 'Ø±Ø§Ø¨Ø·Ø© Ø§Ù„Ø¹Ø§Ù„Ù… Ø§Ù„Ø¥Ø³Ù„Ø§Ù…ÙŠ' }}</option>
                    <option value="MAKKAH">{{ language === 'en' ? 'Umm Al-Qura University, Makkah' : 'Ø¬Ø§Ù…Ø¹Ø© Ø£Ù… Ø§Ù„Ù‚Ø±Ù‰ØŒ Ù…ÙƒØ©' }}</option>
                    <option value="EGYPT">{{ language === 'en' ? 'Egyptian General Authority' : 'Ø§Ù„Ù‡ÙŠØ¦Ø© Ø§Ù„Ø¹Ø§Ù…Ø© Ø§Ù„Ù…ØµØ±ÙŠØ©' }}</option>
                    <option value="KARACHI">{{ language === 'en' ? 'University of Islamic Sciences, Karachi' : 'Ø¬Ø§Ù…Ø¹Ø© Ø§Ù„Ø¹Ù„ÙˆÙ… Ø§Ù„Ø¥Ø³Ù„Ø§Ù…ÙŠØ©ØŒ ÙƒØ±Ø§ØªØ´ÙŠ' }}</option>
                </select>
                <div class="absolute right-3 top-1/2 transform -translate-y-1/2 pointer-events-none text-slate-500 dark:text-slate-400">
                    <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7" />
                    </svg>
                </div>
            </div>
        </div>
        
        <div class="group">
            <label class="block text-sm font-medium mb-2 text-slate-700 dark:text-slate-300 group-hover:text-indigo-600 dark:group-hover:text-indigo-400 transition-colors duration-300">{{ language === 'en' ? 'Select City' : 'Ø§Ø®ØªØ± Ø§Ù„Ù…Ø¯ÙŠÙ†Ø©' }}</label>
            <div class="relative">
                <select v-model="selectedCity" @change="handleCityChange"
                        class="w-full p-3 border border-slate-300 dark:border-slate-600 rounded-xl focus:ring-2 focus:ring-indigo-300 dark:focus:ring-indigo-700 focus:border-indigo-500 dark:focus:border-indigo-500 focus:outline-none bg-white dark:bg-slate-700 text-slate-800 dark:text-slate-200 pr-10 appearance-none transition-all duration-300">
                    <option value="auto">{{ language === 'en' ? 'Auto Detect' : 'ÙƒØ´Ù ØªÙ„Ù‚Ø§Ø¦ÙŠ' }}</option>
                    <option value="alain">{{ language === 'en' ? 'Al-Ain, UAE' : 'Ø§Ù„Ø¹ÙŠÙ†ØŒ Ø§Ù„Ø¥Ù…Ø§Ø±Ø§Øª' }}</option>
                    <option value="mecca">{{ language === 'en' ? 'Mecca, Saudi Arabia' : 'Ù…ÙƒØ© Ø§Ù„Ù…ÙƒØ±Ù…Ø©ØŒ Ø§Ù„Ø³Ø¹ÙˆØ¯ÙŠØ©' }}</option>
                    <option value="medina">{{ language === 'en' ? 'Medina, Saudi Arabia' : 'Ø§Ù„Ù…Ø¯ÙŠÙ†Ø© Ø§Ù„Ù…Ù†ÙˆØ±Ø©ØŒ Ø§Ù„Ø³Ø¹ÙˆØ¯ÙŠØ©' }}</option>
                    <option value="riyadh">{{ language === 'en' ? 'Riyadh, Saudi Arabia' : 'Ø§Ù„Ø±ÙŠØ§Ø¶ØŒ Ø§Ù„Ø³Ø¹ÙˆØ¯ÙŠØ©' }}</option>
                    <option value="cairo">{{ language === 'en' ? 'Cairo, Egypt' : 'Ø§Ù„Ù‚Ø§Ù‡Ø±Ø©ØŒ Ù…ØµØ±' }}</option>
                    <option value="dubai">{{ language === 'en' ? 'Dubai, UAE' : 'Ø¯Ø¨ÙŠØŒ Ø§Ù„Ø¥Ù…Ø§Ø±Ø§Øª' }}</option>
                    <option value="custom">{{ language === 'en' ? 'Custom Location' : 'Ù…ÙˆÙ‚Ø¹ Ù…Ø®ØµØµ' }}</option>
                </select>
                <div class="absolute right-3 top-1/2 transform -translate-y-1/2 pointer-events-none text-slate-500 dark:text-slate-400">
                    <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7" />
                    </svg>
                </div>
            </div>
        </div>
        
        <div v-if="selectedCity === 'custom' || selectedCity === 'auto'" class="grid grid-cols-2 gap-4">
            <div class="group">
                <label class="block text-sm font-medium mb-2 text-slate-700 dark:text-slate-300 group-hover:text-indigo-600 dark:group-hover:text-indigo-400 transition-colors duration-300">{{ language === 'en' ? 'Latitude' : 'Ø®Ø· Ø§Ù„Ø¹Ø±Ø¶' }}</label>
                <div class="relative">
                    <input type="number" v-model="latitude" step="0.0001"
                           class="w-full p-3 border border-slate-300 dark:border-slate-600 rounded-xl focus:ring-2 focus:ring-indigo-300 dark:focus:ring-indigo-700 focus:border-indigo-500 dark:focus:border-indigo-500 focus:outline-none bg-white dark:bg-slate-700 text-slate-800 dark:text-slate-200 transition-all duration-300">
                    <div class="absolute right-3 top-1/2 transform -translate-y-1/2 pointer-events-none text-slate-400 dark:text-slate-500 text-xs">Â°N</div>
                </div>
            </div>
            <div class="group">
                <label class="block text-sm font-medium mb-2 text-slate-700 dark:text-slate-300 group-hover:text-indigo-600 dark:group-hover:text-indigo-400 transition-colors duration-300">{{ language === 'en' ? 'Longitude' : 'Ø®Ø· Ø§Ù„Ø·ÙˆÙ„' }}</label>
                <div class="relative">
                    <input type="number" v-model="longitude" step="0.0001"
                           class="w-full p-3 border border-slate-300 dark:border-slate-600 rounded-xl focus:ring-2 focus:ring-indigo-300 dark:focus:ring-indigo-700 focus:border-indigo-500 dark:focus:border-indigo-500 focus:outline-none bg-white dark:bg-slate-700 text-slate-800 dark:text-slate-200 transition-all duration-300">
                    <div class="absolute right-3 top-1/2 transform -translate-y-1/2 pointer-events-none text-slate-400 dark:text-slate-500 text-xs">Â°E</div>
                </div>
            </div>
        </div>
        
        <button @click="updateLocation" :disabled="isLoading"
                class="w-full mt-2 bg-gradient-to-r from-indigo-600 to-purple-600 hover:from-indigo-700 hover:to-purple-700 text-white font-medium py-3 px-4 rounded-xl transition-all duration-300 disabled:opacity-50 disabled:cursor-not-allowed shadow-md hover:shadow-lg transform hover:-translate-y-0.5 active:translate-y-0">
            <div class="flex items-center justify-center">
                <span v-if="isLoading" class="inline-block animate-spin mr-2">
                    <svg class="w-5 h-5" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24">
                        <circle class="opacity-25" cx="12" cy="12" r="10" stroke="currentColor" stroke-width="4"></circle>
                        <path class="opacity-75" fill="currentColor" d="M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"></path>
                    </svg>
                </span>
                {{ isLoading ? (language === 'en' ? 'Updating...' : 'Ø¬Ø§Ø±Ù Ø§Ù„ØªØ­Ø¯ÙŠØ«...') : (language === 'en' ? 'Update Location' : 'ØªØ­Ø¯ÙŠØ« Ø§Ù„Ù…ÙˆÙ‚Ø¹') }}
            </div>
        </button>
        
        <div :class="{'bg-green-50 dark:bg-green-900/20 border-green-200 dark:border-green-800 text-green-700 dark:text-green-400': !isLoading && statusMessage && !statusMessage.includes('Error'),
                    'bg-indigo-50 dark:bg-indigo-900/20 border-indigo-200 dark:border-indigo-800 text-indigo-700 dark:text-indigo-400': isLoading,
                    'bg-red-50 dark:bg-red-900/20 border-red-200 dark:border-red-800 text-red-700 dark:text-red-400': !isLoading && statusMessage && statusMessage.includes('Error')}"
             class="text-sm p-4 rounded-xl border mt-4 transition-all duration-300" v-if="statusMessage || isLoading">
            <div class="flex items-center">
                <svg v-if="!isLoading && statusMessage && !statusMessage.includes('Error')" xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 mr-2" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7" />
                </svg>
                <svg v-if="!isLoading && statusMessage && statusMessage.includes('Error')" xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 mr-2" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 8v4m0 4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z" />
                </svg>
                <span v-if="isLoading" class="inline-block animate-spin mr-2">
                    <svg class="w-5 h-5" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24">
                        <circle class="opacity-25" cx="12" cy="12" r="10" stroke="currentColor" stroke-width="4"></circle>
                        <path class="opacity-75" fill="currentColor" d="M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"></path>
                    </svg>
                </span>
                {{ language === 'en' ? statusMessage : statusMessageArabic }}
            </div>
        </div>
    </div>
    
    <!-- Additional Features Section -->
    <div class="mt-8 pt-6 border-t border-slate-200 dark:border-slate-700">
        <h3 class="text-lg font-medium mb-4 text-slate-700 dark:text-slate-300">{{ language === 'en' ? 'Additional Features' : 'Ù…ÙŠØ²Ø§Øª Ø¥Ø¶Ø§ÙÙŠØ©' }}</h3>
        
        <div class="space-y-3">
            <div class="flex items-center">
                <label class="inline-flex items-center cursor-pointer">
                    <input type="checkbox" class="sr-only peer" v-model="enableNotifications">
                    <div class="relative w-11 h-6 bg-slate-200 peer-focus:outline-none peer-focus:ring-4 peer-focus:ring-indigo-300 dark:peer-focus:ring-indigo-800 rounded-full peer dark:bg-slate-700 peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:border-slate-300 after:border after:rounded-full after:h-5 after:w-5 after:transition-all dark:border-slate-600 peer-checked:bg-indigo-600"></div>
                    <span class="ml-3 text-sm font-medium text-slate-700 dark:text-slate-300">{{ language === 'en' ? 'Enable Notifications' : 'ØªÙØ¹ÙŠÙ„ Ø§Ù„Ø¥Ø´Ø¹Ø§Ø±Ø§Øª' }}</span>
                </label>
            </div>
            
            <div class="flex items-center">
                <label class="inline-flex items-center cursor-pointer">
                    <input type="checkbox" class="sr-only peer" v-model="enableSounds">
                    <div class="relative w-11 h-6 bg-slate-200 peer-focus:outline-none peer-focus:ring-4 peer-focus:ring-indigo-300 dark:peer-focus:ring-indigo-800 rounded-full peer dark:bg-slate-700 peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:border-slate-300 after:border after:rounded-full after:h-5 after:w-5 after:transition-all dark:border-slate-600 peer-checked:bg-indigo-600"></div>
                    <span class="ml-3 text-sm font-medium text-slate-700 dark:text-slate-300">{{ language === 'en' ? 'Enable Prayer Sounds' : 'ØªÙØ¹ÙŠÙ„ Ø£ØµÙˆØ§Øª Ø§Ù„ØµÙ„Ø§Ø©' }}</span>
                </label>
            </div>
            
            <div class="flex items-center">
                <label class="inline-flex items-center cursor-pointer">
                    <input type="checkbox" class="sr-only peer" v-model="showSecondaryTimes">
                                                <div class="relative w-11 h-6 bg-slate-200 peer-focus:outline-none peer-focus:ring-4 peer-focus:ring-indigo-300 dark:peer-focus:ring-indigo-800 rounded-full peer dark:bg-slate-700 peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:border-slate-300 after:border after:rounded-full after:h-5 after:w-5 after:transition-all dark:border-slate-600 peer-checked:bg-indigo-600"></div>
                            <span class="ml-3 text-sm font-medium text-slate-700 dark:text-slate-300">{{ language === 'en' ? 'Show All Prayer Times' : 'Ø¹Ø±Ø¶ Ø¬Ù…ÙŠØ¹ Ø£ÙˆÙ‚Ø§Øª Ø§Ù„ØµÙ„Ø§Ø©' }}</span>
                        </label>
                    </div>
                </div>
                
                <!-- Secondary Prayer Times (Conditionally Shown) -->
                <div v-if="showSecondaryTimes" class="mt-4 grid grid-cols-2 sm:grid-cols-3 gap-3 text-center">
                    <div class="bg-slate-50 dark:bg-slate-700/50 rounded-lg p-3 border border-slate-200 dark:border-slate-700">
                        <h4 class="text-xs font-medium text-slate-500 dark:text-slate-400">{{ language === 'en' ? 'Fajr' : 'Ø§Ù„ÙØ¬Ø±' }}</h4>
                        <p class="text-indigo-600 dark:text-indigo-400 font-medium">{{ formatTime(prayerTimes.Fajr) || '--:--' }}</p>
                    </div>
                    <div class="bg-slate-50 dark:bg-slate-700/50 rounded-lg p-3 border border-slate-200 dark:border-slate-700">
                        <h4 class="text-xs font-medium text-slate-500 dark:text-slate-400">{{ language === 'en' ? 'Dhuhr' : 'Ø§Ù„Ø¸Ù‡Ø±' }}</h4>
                        <p class="text-indigo-600 dark:text-indigo-400 font-medium">{{ formatTime(prayerTimes.Dhuhr) || '--:--' }}</p>
                    </div>
                    <div class="bg-slate-50 dark:bg-slate-700/50 rounded-lg p-3 border border-slate-200 dark:border-slate-700">
                        <h4 class="text-xs font-medium text-slate-500 dark:text-slate-400">{{ language === 'en' ? 'Asr' : 'Ø§Ù„Ø¹ØµØ±' }}</h4>
                        <p class="text-indigo-600 dark:text-indigo-400 font-medium">{{ formatTime(prayerTimes.Asr) || '--:--' }}</p>
                    </div>
                    <div class="bg-slate-50 dark:bg-slate-700/50 rounded-lg p-3 border border-slate-200 dark:border-slate-700">
                        <h4 class="text-xs font-medium text-slate-500 dark:text-slate-400">{{ language === 'en' ? 'Maghrib' : 'Ø§Ù„Ù…ØºØ±Ø¨' }}</h4>
                        <p class="text-indigo-600 dark:text-indigo-400 font-medium">{{ formatTime(prayerTimes.Maghrib) || '--:--' }}</p>
                    </div>
                    <div class="bg-slate-50 dark:bg-slate-700/50 rounded-lg p-3 border border-slate-200 dark:border-slate-700">
                        <h4 class="text-xs font-medium text-slate-500 dark:text-slate-400">{{ language === 'en' ? 'Isha' : 'Ø§Ù„Ø¹Ø´Ø§Ø¡' }}</h4>
                        <p class="text-indigo-600 dark:text-indigo-400 font-medium">{{ formatTime(prayerTimes.Isha) || '--:--' }}</p>
                    </div>
                    <div class="bg-slate-50 dark:bg-slate-700/50 rounded-lg p-3 border border-slate-200 dark:border-slate-700">
                        <h4 class="text-xs font-medium text-slate-500 dark:text-slate-400">{{ language === 'en' ? 'Midnight' : 'Ù…Ù†ØªØµÙ Ø§Ù„Ù„ÙŠÙ„' }}</h4>
                        <p class="text-indigo-600 dark:text-indigo-400 font-medium">{{ formatTime(prayerTimes.Midnight) || '--:--' }}</p>
                    </div>
                </div>
            </div>
        </div>
    </div>
    
    <!-- Quote of the Day -->
    <div class="mt-6 bg-gradient-to-r from-indigo-50 to-purple-50 dark:from-indigo-900/30 dark:to-purple-900/30 backdrop-blur-sm rounded-2xl shadow-md overflow-hidden p-6 border border-indigo-100 dark:border-indigo-800/50">
        <div class="flex items-start">
            <svg xmlns="http://www.w3.org/2000/svg" class="h-8 w-8 text-indigo-500 dark:text-indigo-400 mr-4 shrink-0 mt-1" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 10h.01M12 10h.01M16 10h.01M9 16H5a2 2 0 01-2-2V6a2 2 0 012-2h14a2 2 0 012 2v8a2 2 0 01-2 2h-5l-5 5v-5z" />
            </svg>
            <div>
                <h3 class="text-lg font-medium mb-3 text-indigo-700 dark:text-indigo-400">{{ language === 'en' ? 'Ramadan Quote of the Day' : 'Ø­ÙƒÙ…Ø© Ø±Ù…Ø¶Ø§Ù†ÙŠØ© Ù„Ù„ÙŠÙˆÙ…' }}</h3>
                <p class="text-slate-600 dark:text-slate-300 italic">{{ language === 'en' ? dailyQuote.en : dailyQuote.ar }}</p>
                <p class="text-slate-500 dark:text-slate-400 text-sm mt-2">â€” {{ language === 'en' ? dailyQuote.source : dailyQuote.sourceAr }}</p>
            </div>
        </div>
    </div>
    
    <footer class="mt-8 text-center text-sm text-slate-500 dark:text-slate-400 py-4 border-t border-slate-200 dark:border-slate-800">
        <div class="flex flex-col sm:flex-row justify-center items-center gap-2 sm:gap-6">
            <p>{{ language === 'en' ? 'Prayer times provided by Aladhan API' : 'Ø£ÙˆÙ‚Ø§Øª Ø§Ù„ØµÙ„Ø§Ø© Ù…Ù‚Ø¯Ù…Ø© Ù…Ù† ÙˆØ§Ø¬Ù‡Ø© Ø¨Ø±Ù…Ø¬Ø© ØªØ·Ø¨ÙŠÙ‚Ø§Øª Ø§Ù„Ø£Ø°Ø§Ù†' }}</p>
            <div class="hidden sm:block h-1 w-1 rounded-full bg-slate-300 dark:bg-slate-700"></div>
            <p>{{ language === 'en' ? 'Â© Ramadan Timer 2025 By Oby Majid' : 'Ù…Ø¤Ù‚Øª Ø±Ù…Ø¶Ø§Ù† Â© ØŒØ£Ø¨ÙŠ Ù…Ø§Ø¬Ø¯ Ù¢Ù Ù¢Ù¥' }}</p>
        </div>
    </footer>
</div>

<!-- Notification Panel (Hidden by default) -->
<div class="fixed bottom-4 right-4 transition-all duration-300 transform translate-y-full opacity-0" :class="{'translate-y-0 opacity-100': showNotification}">
    <div class="bg-white dark:bg-slate-800 rounded-lg shadow-xl p-4 max-w-xs border border-slate-200 dark:border-slate-700 flex items-start">
        <div class="p-2 bg-indigo-100 dark:bg-indigo-900/50 rounded-full mr-3 shrink-0">
            <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6 text-indigo-600 dark:text-indigo-400" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z" />
            </svg>
        </div>
        <div>
            <h4 class="font-medium text-slate-800 dark:text-slate-200">{{ notificationTitle }}</h4>
            <p class="text-sm text-slate-600 dark:text-slate-400">{{ notificationMessage }}</p>
        </div>
    </div>
</div>
<script>
    const { createApp, ref, computed, onMounted, watch, shallowRef } = Vue;

    createApp({
        setup() {
            const enableNotifications = ref(false);
            const enableSounds = ref(false);
            const showSecondaryTimes = ref(false);
            const dailyQuote = ref({source:"Thank God",sourceAr:"Ø§Ù„Ø­Ù…Ø¯ Ù„Ù„Ù‡"});
            const language = ref('en');
            const currentDay = ref(1);
            const phaseName = ref('');
            const currentDate = ref('');
            const currentDateArabic = ref('');
            const hijriDate = ref('');
            const hijriDateArabic = ref('');
            const countdownLabel = ref('Time until Iftar');
            const countdownLabelArabic = ref('Ø§Ù„ÙˆÙ‚Øª Ø§Ù„Ù…ØªØ¨Ù‚ÙŠ Ø­ØªÙ‰ Ø§Ù„Ø¥ÙØ·Ø§Ø±');
            const countdownTime = ref({ hours: '00', minutes: '00', seconds: '00' });
            const progressPercentage = ref(0);
            const prayerTimes = shallowRef({ suhoor: '04:30', iftar: '18:45' });
            const fastDuration = ref('00:00');
            const fastDurationArabic = ref('00:00');
            const calculationMethod = ref('MAKKAH');
            const selectedCity = ref('auto');
            const latitude = ref(0);
            const longitude = ref(0);
            const isLoading = ref(false);
            const statusMessage = ref('Ready to update');
            const statusMessageArabic = ref('Ø¬Ø§Ù‡Ø² Ù„Ù„ØªØ­Ø¯ÙŠØ«');
            const _moonPhaseStyle = ref({ transform: 'rotate(0deg)' });
            const hijriMonthData = ref(null);
            const currentPeriod = ref(''); // 'pre-suhoor', 'fasting', or 'post-iftar'
            const darkMode = ref(false);

           const toggleDarkMode = () => {
            darkMode.value = !darkMode.value;
            console.log('Dark Mode Toggled:', darkMode.value); // Debugging line
            if (darkMode.value) {
                document.documentElement.classList.add('dark');
                console.log('Added dark class to document'); // Debugging line
            } else {
                document.documentElement.classList.remove('dark');
                console.log('Removed dark class from document'); // Debugging line
            }
            // Store preference in local storage
            localStorage.setItem('darkMode', darkMode.value);
            console.log('Saved Dark Mode:', localStorage.getItem('darkMode')); // Debugging line
        };

        // Initialize dark mode based on system preference or saved preference
        const initDarkMode = () => {
            // Check for saved preference
            const savedDarkMode = localStorage.getItem('darkMode');
            console.log('Saved Dark Mode:', savedDarkMode); // Debugging line
            if (savedDarkMode !== null) {
                darkMode.value = savedDarkMode === 'true';
            } else {
                // Check system preference
                darkMode.value = window.matchMedia('(prefers-color-scheme: dark)').matches;
            }
            console.log('Initial Dark Mode:', darkMode.value); // Debugging line
            if (darkMode.value) {
                document.documentElement.classList.add('dark');
                console.log('Added dark class to document on init'); // Debugging line
            }
        };


            // Predefined city coordinates
            const cities = {
                alain: { lat: 24.1302, lng: 55.8023 },
                mecca: { lat: 21.4225, lng: 39.8262 },
                medina: { lat: 24.5247, lng: 39.5692 },
                riyadh: { lat: 24.7136, lng: 46.6753 },
                cairo: { lat: 30.0444, lng: 31.2357 },
                dubai: { lat: 25.2048, lng: 55.2708 }
            };

            const toggleLanguage = () => {
                language.value = language.value === 'en' ? 'ar' : 'en';
            };

            const handleCityChange = () => {
                if (selectedCity.value === 'auto') {
                    detectLocation();
                } else if (selectedCity.value !== 'custom') {
                    const city = cities[selectedCity.value];
                    latitude.value = city.lat;
                    longitude.value = city.lng;
                }
            };

            const detectLocation = async () => {
                if (navigator.geolocation) {
                    isLoading.value = true;
                    statusMessage.value = 'Detecting your location...';
                    statusMessageArabic.value = 'Ø¬Ø§Ø±Ù Ø§Ù„ÙƒØ´Ù Ø¹Ù† Ù…ÙˆÙ‚Ø¹Ùƒ...';
                    
                    try {
                        const position = await new Promise((resolve, reject) => {
                            navigator.geolocation.getCurrentPosition(resolve, reject);
                        });
                        
                        latitude.value = position.coords.latitude;
                        longitude.value = position.coords.longitude;
                        
                        await fetchPrayerTimes();
                        await fetchHijriDate();
                        
                        statusMessage.value = 'Location detected successfully';
                        statusMessageArabic.value = 'ØªÙ… Ø§Ù„ÙƒØ´Ù Ø¹Ù† Ø§Ù„Ù…ÙˆÙ‚Ø¹ Ø¨Ù†Ø¬Ø§Ø­';
                    } catch (error) {
                        console.error("Error getting location:", error);
                        statusMessage.value = 'Could not detect location. Using default.';
                        statusMessageArabic.value = 'ØªØ¹Ø°Ø± Ø§Ù„ÙƒØ´Ù Ø¹Ù† Ø§Ù„Ù…ÙˆÙ‚Ø¹. Ø§Ø³ØªØ®Ø¯Ø§Ù… Ø§Ù„Ø§ÙØªØ±Ø§Ø¶ÙŠ.';
                        
                        // Default to Mecca if geolocation fails
                        latitude.value = cities.alain.lat;
                        longitude.value = cities.alain.lng;
                        selectedCity.value = 'alain';
                        await fetchPrayerTimes();
                        await fetchHijriDate();
                    } finally {
                        isLoading.value = false;
                    }
                } else {
                    statusMessage.value = 'Geolocation not supported by your browser';
                    statusMessageArabic.value = 'ØªØ­Ø¯ÙŠØ¯ Ø§Ù„Ù…ÙˆÙ‚Ø¹ Ø§Ù„Ø¬ØºØ±Ø§ÙÙŠ ØºÙŠØ± Ù…Ø¯Ø¹ÙˆÙ… Ù…Ù† Ù…ØªØµÙØ­Ùƒ';
                }
            };

            const updateLocation = async () => {
                isLoading.value = true;
                try {
                    await fetchPrayerTimes();
                    await fetchHijriDate();
                    statusMessage.value = 'Location updated successfully';
                    statusMessageArabic.value = 'ØªÙ… ØªØ­Ø¯ÙŠØ« Ø§Ù„Ù…ÙˆÙ‚Ø¹ Ø¨Ù†Ø¬Ø§Ø­';
                } catch (error) {
                    console.error("Error updating location:", error);
                    statusMessage.value = 'Failed to update location. Please try again.';
                    statusMessageArabic.value = 'ÙØ´Ù„ ØªØ­Ø¯ÙŠØ« Ø§Ù„Ù…ÙˆÙ‚Ø¹. ÙŠØ±Ø¬Ù‰ Ø§Ù„Ù…Ø­Ø§ÙˆÙ„Ø© Ù…Ø±Ø© Ø£Ø®Ø±Ù‰.';
                } finally {
                    isLoading.value = false;
                }
            };

            const fetchHijriDate = async () => {
                try {
                    const today = new Date();
                    const year = today.getFullYear();
                    const month = today.getMonth() + 1;
                    const day = today.getDate();
                    
                    const response = await fetch(`https://api.aladhan.com/v1/gToH?date=${day}-${month}-${year}`);
                    const data = await response.json();
                    
                    if (data.code === 200 && data.data) {
                        const hijri = data.data.hijri;
                        hijriDate.value = `${hijri.month.en} ${hijri.day}, ${hijri.year} AH`;
                        hijriDateArabic.value = `${hijri.day} ${hijri.month.ar}ØŒ ${convertToArabicNumerals(hijri.year)} Ù‡Ù€`;
                        
                        // Check if we're in Ramadan
                        if (hijri.month.number === 9) {
                            // Fetch Ramadan data for this year
                            await fetchRamadanData(hijri.year);
                            
                            // Set current day of Ramadan
                            currentDay.value = parseInt(hijri.day);
                            calculateMoonPhase(parseInt(hijri.day));
                        } else {
                            // Not Ramadan - could handle differently
                            currentDay.value = 1;
                            calculateMoonPhase(1);
                        }
                    }
                } catch (error) {
                    console.error("Error fetching Hijri date:", error);
                }
            };

            const fetchRamadanData = async (hijriYear) => {
                try {
                    const response = await fetch(`https://api.aladhan.com/v1/hijriCalendarByYear/${hijriYear}?month=9`);
                    const data = await response.json();
                    
                    if (data.code === 200 && data.data) {
                        hijriMonthData.value = data.data;
                    }
                } catch (error) {
                    console.error("Error fetching Ramadan data:", error);
                }
            };

            const formatTime = (timeStr) => {
                const time = timeStr.split(" ")[0]; // Remove timezone info
                const [hours, minutes] = time.split(":");
                const hour = parseInt(hours);
                const ampm = hour >= 12 ? "PM" : "AM";
                const hour12 = hour % 12 || 12;
                return `${hour12}:${minutes} ${ampm}`;
            };

            const fetchPrayerTimes = async () => {
                try {
                    const today = new Date();
                    const year = today.getFullYear();
                    const month = today.getMonth() + 1;
                    const day = today.getDate();
                    
                    // Fetch prayer times using Aladhan API
                    const response = await fetch(
                        `https://api.aladhan.com/v1/timings/${day}-${month}-${year}?latitude=${latitude.value}&longitude=${longitude.value}&method=${calculationMethod.value}`
                    );
                    const data = await response.json();
                    
                    if (data.code === 200 && data.data) {
                        const timings = data.data.timings;
                        console.log(data.data.timings)
                        // Use Fajr time as Suhoor end time (with 10 minutes buffer before)
                        const fajrTime = timings.Fajr;
                        
                        const fajrHour = parseInt(fajrTime.split(':')[0]);
                        const fajrMinute = parseInt(fajrTime.split(':')[1]);
                        
                        // Calculate 10 minutes before Fajr for Suhoor
                        let suhoorMinute = fajrMinute - 10;
                        let suhoorHour = fajrHour;
                        
                        if (suhoorMinute < 0) {
                            suhoorMinute += 60;
                            suhoorHour -= 1;
                            if (suhoorHour < 0) suhoorHour += 24;
                        }
                        
                                                    const suhoorTime = `${suhoorHour.toString().padStart(2, '0')}:${suhoorMinute.toString().padStart(2, '0')}`;
                            
                            // Use Maghrib time as Iftar time
                            const iftarTime = timings.Maghrib;
                            
                            prayerTimes.value = {
                                ...data.data.timings,
                                suhoor: (suhoorTime),
                                iftar: (iftarTime)
                            };
                            
                            // Calculate fast duration
                            const suhoorParts = suhoorTime.split(':');
                            const iftarParts = iftarTime.split(':');
                            
                            const suhoorMinutes = parseInt(suhoorParts[0]) * 60 + parseInt(suhoorParts[1]);
                            const iftarMinutes = parseInt(iftarParts[0]) * 60 + parseInt(iftarParts[1]);
                            
                            let fastMinutes = iftarMinutes - suhoorMinutes;
                            if (fastMinutes < 0) fastMinutes += 24 * 60;
                            
                            const fastHours = Math.floor(fastMinutes / 60);
                            const fastMins = fastMinutes % 60;
                            
                            fastDuration.value = `${fastHours}h ${fastMins}m`;
                            fastDurationArabic.value = `${fastHours} Ø³Ø§Ø¹Ø© ${fastMins} Ø¯Ù‚ÙŠÙ‚Ø©`;
                        }
                    } catch (error) {
                        console.error("Error fetching prayer times:", error);
                        
                        // Fallback to defaults if API fails
                        prayerTimes.value = {
                            suhoor: '04:30',
                            iftar: '18:45'
                        };
                        
                        fastDuration.value = '14h 15m';
                        fastDurationArabic.value = 'Ù¡Ù¤ Ø³Ø§Ø¹Ø© Ù¡Ù¥ Ø¯Ù‚ÙŠÙ‚Ø©';
                    }
                };

const moonPhaseStylex=computed(() => {
    const phase = currentDay.value / 29.5; // 0 to 1 representing the lunar cycle
    let clipPath;
    
    if (phase <= 0.5) {
      // New moon (0) to full moon (0.5)
      const angle = phase * 2 * 180; // 0 to 180 degrees
      clipPath = `polygon(0 0, ${50 - 50 * Math.cos(angle * Math.PI / 180)}% 0, ${50 - 50 * Math.cos(angle * Math.PI / 180)}% 100%, 0 100%)`;
    } else {
      // Full moon (0.5) to new moon (1.0)
      const angle = (phase - 0.5) * 2 * 180; // 0 to 180 degrees
      clipPath = `polygon(100% 0, 100% 100%, ${50 + 50 * Math.cos(angle * Math.PI / 180)}% 100%, ${50 + 50 * Math.cos(angle * Math.PI / 180)}% 0)`;
    }
    
    return {
      clipPath: clipPath
    };
  });
                const _calculateMoonPhase = (dayOfRamadan) => {
                    // More accurate moon phase calculation based on the day of Ramadan
                    // Ramadan is 29 or 30 days, with new moon at start and end
                    
                    if (dayOfRamadan <= 14) {
                        phaseName.value = language.value === 'en' ? 'Waxing Crescent' : 'Ù‡Ù„Ø§Ù„ Ù…ØªØ²Ø§ÙŠØ¯';
                        const rotationDegree = (dayOfRamadan / 14) * 180;
                        moonPhaseStyle.value = { transform: `rotate(${rotationDegree}deg)` };
                    } else {
                        phaseName.value = language.value === 'en' ? 'Waning Crescent' : 'Ù‡Ù„Ø§Ù„ Ù…ØªÙ†Ø§Ù‚Øµ';
                        const rotationDegree = ((dayOfRamadan - 14) / 15.5) * 180;
                        //moonPhaseStyle.value = { transform: `rotate(${180 + rotationDegree}deg)` };
                    }
                };

                const updateDateTime = () => {
                    const now = new Date();
                    
                    // Format Gregorian date
                    const options = { weekday: 'long', year: 'numeric', month: 'long', day: 'numeric' };
                    currentDate.value = now.toLocaleDateString('en-US', options);
                    currentDateArabic.value = now.toLocaleDateString('ar-SA', options);
                    
                    updateCountdown();
                };

                const updateCountdown = () => {
                    const now = new Date();
                    const hours = now.getHours();
                    const minutes = now.getMinutes();
                    const seconds = now.getSeconds();
                    
                    // Convert times to minutes since midnight
                    const currentMinutes = hours * 60 + minutes;
                    
                    // Parse prayer times
                    const iftarParts = prayerTimes.value.iftar.split(':');
                    const iftarMinutes = parseInt(iftarParts[0]) * 60 + parseInt(iftarParts[1]);
                    
                    const suhoorParts = prayerTimes.value.suhoor.split(':');
                    const suhoorMinutes = parseInt(suhoorParts[0]) * 60 + parseInt(suhoorParts[1]);
                    
                    // Calculate next day's suhoor time for post-iftar countdown
                    const nextSuhoorMinutes = suhoorMinutes + (24 * 60);
                    
                    let timeUntilEvent = 0;
                    
                    // Determine current period and closest event
                    if (currentMinutes < suhoorMinutes) {
                        // Before suhoor
                        currentPeriod.value = 'pre-suhoor';
                        timeUntilEvent = suhoorMinutes - currentMinutes;
                        countdownLabel.value = 'Time until Imsak';
                        countdownLabelArabic.value = 'Ø§Ù„ÙˆÙ‚Øª Ø§Ù„Ù…ØªØ¨Ù‚ÙŠ Ø­ØªÙ‰ Ø§Ù„Ø£Ù…Ø³Ø§Ùƒ';
                        
                        // Progress for approaching suhoor
                        progressPercentage.value = Math.min(100, Math.max(0, 
                            Math.round(((24 * 60 - iftarMinutes + currentMinutes) / (24 * 60 - iftarMinutes + suhoorMinutes)) * 100)
                        ));
                        
                    } else if (currentMinutes < iftarMinutes) {
                        // During fasting period
                        currentPeriod.value = 'fasting';
                        timeUntilEvent = iftarMinutes - currentMinutes;
                        countdownLabel.value = 'Time until Iftar';
                        countdownLabelArabic.value = 'Ø§Ù„ÙˆÙ‚Øª Ø§Ù„Ù…ØªØ¨Ù‚ÙŠ Ø­ØªÙ‰ Ø§Ù„Ø¥ÙØ·Ø§Ø±';
                        
                        // Progress toward iftar
                        const totalFastingTime = iftarMinutes - suhoorMinutes;
                        const timePassed = currentMinutes - suhoorMinutes;
                        progressPercentage.value = Math.min(100, Math.max(0, Math.round((timePassed / totalFastingTime) * 100)));
                        
                    } else {
                        // After iftar, counting to next day's suhoor
                        currentPeriod.value = 'post-iftar';
                        timeUntilEvent = nextSuhoorMinutes - currentMinutes;
                        countdownLabel.value = 'Time until Imsak';
                        countdownLabelArabic.value = 'Ø§Ù„ÙˆÙ‚Øª Ø§Ù„Ù…ØªØ¨Ù‚ÙŠ Ø­ØªÙ‰ Ø§Ù„Ø£Ù…Ø³Ø§Ùƒ';
                        
                        // Progress toward next suhoor
                        const totalTimeUntilSuhoor = nextSuhoorMinutes - iftarMinutes;
                        const timePassed = currentMinutes - iftarMinutes;
                        progressPercentage.value = Math.min(100, Math.max(0, Math.round((timePassed / totalTimeUntilSuhoor) * 100)));
                    }
                    
                    // Calculate countdown display values
                    const countdownHours = Math.floor(timeUntilEvent / 60);
                    const countdownMinutes = Math.floor(timeUntilEvent % 60);
                    
                    countdownTime.value = {
                        hours: countdownHours.toString().padStart(2, '0'),
                        minutes: countdownMinutes.toString().padStart(2, '0'),
                        seconds: (59 - seconds).toString().padStart(2, '0')
                    };
                };

                // Helper function to convert numbers to Arabic numerals
                const convertToArabicNumerals = (num) => {
                    const arabicNumerals = ['Ù ', 'Ù¡', 'Ù¢', 'Ù£', 'Ù¤', 'Ù¥', 'Ù¦', 'Ù§', 'Ù¨', 'Ù©'];
                    return num.toString().split('').map(digit => 
                        !isNaN(parseInt(digit)) ? arabicNumerals[parseInt(digit)] : digit
                    ).join('');
                };

                onMounted(() => {
                    initDarkMode();
                    detectLocation();
                    updateDateTime();
                    
                    // Set up timers
                    setInterval(updateDateTime, 60000); // Update date every minute
                    setInterval(updateCountdown, 1000); // Update countdown every second
                    
                    // Listen for system dark mode changes
                    window.matchMedia('(prefers-color-scheme: dark)').addEventListener('change', event => {
                        if (event.matches) {
                            darkMode.value = true;
                            document.documentElement.classList.add('dark');
                        } else {
                            darkMode.value = false;
                            document.documentElement.classList.remove('dark');
                        }
                        localStorage.setItem('darkMode', darkMode.value);
                    });
                });

                // Update moon phase language when language changes
                watch(language, () => {
                    calculateMoonPhase(currentDay.value);
                });
const moonPhaseStyle = computed(() => {
      const phase = currentDay.value / 29.5; // Lunar cycle normalized to 0-1
      const angle = phase * 360; // Convert to degrees
      
      // Enhanced phase calculation
      if (phase <= 0.5) {
        // Waxing phase (new moon to full moon)
        const x = 50 - 50 * Math.cos(angle * Math.PI / 180);
        return {
          clipPath: `polygon(
            0 0, 
            ${x}% 0, 
            ${x}% 100%, 
            0 100%
          )`,
          transform: `rotate(${angle}deg)`
        };
      } else {
        // Waning phase (full moon to new moon)
        const x = 50 + 50 * Math.cos((angle - 180) * Math.PI / 180);
        return {
          clipPath: `polygon(
            100% 0, 
            ${x}% 0, 
            ${x}% 100%, 
            100% 100%
          )`,
          transform: `rotate(${angle}deg)`
        };
      }
    });

    const illuminationStyle = computed(() => {
      const phase = currentDay.value / 29.5;
      const intensity = Math.sin(phase * Math.PI) * 100;
      
      return {
        background: `radial-gradient(
          circle at ${phase <= 0.5 ? 'right' : 'left'}, 
          rgba(129, 140, 248, ${intensity}%) 0%,
          transparent 70%
        )`
      };
    });
                // Get progress bar color based on current period
                const progressBarColor = computed(() => {
                    const baseColors = {
                        'pre-suhoor': {
                            light: 'from-blue-500 to-indigo-600',
                            dark: 'from-blue-400 to-indigo-500'
                        },
                        'fasting': {
                            light: 'from-indigo-600 to-purple-600',
                            dark: 'from-indigo-500 to-purple-500'
                        },
                        'post-iftar': {
                            light: 'from-purple-600 to-blue-500',
                            dark: 'from-purple-500 to-blue-400'
                        },
                        'default': {
                            light: 'from-indigo-500 to-purple-500',
                            dark: 'from-indigo-400 to-purple-400'
                        }
                    };
                    
                    const colorSet = baseColors[currentPeriod.value] || baseColors.default;
                    return darkMode.value ? colorSet.dark : colorSet.light;
                });
                const _illuminationStyle = computed(() => {
  const phase = currentDay.value / 29.5;
  const intensity = Math.sin(phase * Math.PI) * 100;
  
  return {
    background: `radial-gradient(
      circle at ${phase <= 0.5 ? 'right' : 'left'}, 
      rgba(129, 140, 248, ${intensity}%) 0%,
      transparent 70%
    )`
  };
});

// Enhanced moon phase calculation function
const calculateMoonPhase = (dayOfRamadan) => {
  const phases = {
    en: [
      'New Moon', 'Waxing Crescent', 'First Quarter',
      'Waxing Gibbous', 'Full Moon', 'Waning Gibbous',
      'Last Quarter', 'Waning Crescent'
    ],
    ar: [
      'Ø§Ù„Ù…Ø­Ø§Ù‚', 'Ø§Ù„Ù‡Ù„Ø§Ù„ Ø§Ù„Ù…ØªØ²Ø§ÙŠØ¯', 'Ø§Ù„ØªØ±Ø¨ÙŠØ¹ Ø§Ù„Ø£ÙˆÙ„',
      'Ø§Ù„Ø£Ø­Ø¯Ø¨ Ø§Ù„Ù…ØªØ²Ø§ÙŠØ¯', 'Ø§Ù„Ø¨Ø¯Ø±', 'Ø§Ù„Ø£Ø­Ø¯Ø¨ Ø§Ù„Ù…ØªÙ†Ø§Ù‚Øµ',
      'Ø§Ù„ØªØ±Ø¨ÙŠØ¹ Ø§Ù„Ø¢Ø®Ø±', 'Ø§Ù„Ù‡Ù„Ø§Ù„ Ø§Ù„Ù…ØªÙ†Ø§Ù‚Øµ'
    ]
  };

  const phase = (dayOfRamadan - 1) / 29.5 * 8;
  const phaseIndex = Math.floor(phase % 8);
  phaseName.value = language.value === 'en' 
    ? phases.en[phaseIndex]
    : phases.ar[phaseIndex];
};
                return {
                    language,
                    darkMode,
                    currentDay,
                    phaseName,
                    currentDate,
                    currentDateArabic,
                    hijriDate,
                    hijriDateArabic,
                    countdownLabel,
                    countdownLabelArabic,
                    countdownTime,
                    progressPercentage,
                    progressBarColor,
                    prayerTimes,
                    fastDuration,
                    fastDurationArabic,
                    calculationMethod,
                    selectedCity,
                    latitude,
                    longitude,
                    isLoading,
                    statusMessage,
                    statusMessageArabic,
                    moonPhaseStyle,
                    currentPeriod,
                    toggleLanguage,
                    toggleDarkMode,
                    handleCityChange,
                    updateLocation,
                    enableNotifications,
                    enableSounds,
                    showSecondaryTimes,
                    dailyQuote,
                    formatTime,
                    moonPhaseStyle,
  illuminationStyle,
  calculateMoonPhase,
  moonPhaseStylex,
                };
            }
        }).mount('#app');
    </script>
</body>
</html>